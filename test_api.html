<!DOCTYPE html>
<html>
    <head>
        <title>File Upload</title>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin="">
        </script>

        <link rel="stylesheet" href="test_api.css">
    </head>
    <body>
        <h1>File Upload</h1>
        <form action="http://localhost:3000/upload" method="POST" enctype="multipart/form-data">
            <input type="file" name="file" required>
            email <input type="text" name="email" required>
            lat <input id="lat" type="number" step="0.0001" name="lat" required>
            lng <input id="lng" type="number" step="0.0001" name="lng" required>
            <div id="map"></div>
            description <input type="text" name="description" required>
            <button type="submit">Upload</button>
        </form>

        <script>
            let map = L.map("map").setView([20.559, -157.242], 8);
            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);
            map.on("click", (e) => {
                let {lat, lng} = e.latlng;
                //round to 6 decimals
                let precision = Math.pow(10, 6);
                lat = Math.round(lat * precision) / precision;
                lng = Math.round(lng * precision) / precision;
                document.getElementById("lat").value = lat;
                document.getElementById("lng").value = lng;
            });
        </script>

    </body>
</html>